<view class="custom-nav" style="padding-top: {{statusBarHeight}}px;">
  <view class="nav-content">
    <view class="nav-back" bindtap="onBack"><text>＜</text></view>
    <text class="nav-title">来玩</text>
  </view>
</view>
<view class="container" style="padding-top: {{navHeight}}px;">
  <!-- 顶部空间已移除星球效果 -->
  <view class="search">
      <view class="search-input">
        <view class="search-icon-btn" bindtap="onSearch">
          <image src="../../assets/search.png" mode="aspectFit" />
        </view>
        <input type="text" placeholder="寻找你感兴趣的活动" placeholder-style="font-size: 24rpx;" bindinput="onSearchInput"/>
      </view>
    </view>

  <view class="filters">
    <view class="dropdown" catchtap="noop">
      <view class="dropdown-trigger" bindtap="toggleLang">
        <text class="dropdown-label">{{selectedLanguage || '选择语种'}}</text>
        <image class="dropdown-icon {{isLangOpen ? 'open' : ''}}" src="../../assets/arrow-down.png" mode="widthFix" />
      </view>
      <view wx:if="{{isLangOpen}}" class="dropdown-list" catchtap="noop">
        <block wx:for="{{languageOptions}}" wx:key="index">
          <view class="dropdown-item" bindtap="selectLang" data-index="{{index}}">{{item}}</view>
        </block>
      </view>
    </view>
    <view class="dropdown" catchtap="noop">
      <view class="dropdown-trigger" bindtap="toggleType">
        <text class="dropdown-label">{{selectedType || '选择类型'}}</text>
      </view>
      <view wx:if="{{isTypeOpen}}" class="dropdown-list" catchtap="noop">
        <block wx:for="{{typeOptions}}" wx:key="index">
          <view class="dropdown-item" bindtap="selectType" data-index="{{index}}">{{item}}</view>
        </block>
      </view>
    </view>
  </view>
  <view wx:if="{{isDropdownMaskVisible}}" class="dropdown-mask" bindtap="closeDropdowns"></view>

  <view class="list" id="activityList">
    <view class="work-page">
      <block wx:for="{{activities}}" wx:key="id">
        <view class="card" bindtap="onTap" data-id="{{item.id}}">
          <image class="thumb" src="{{item.mainImage}}" mode="aspectFill" />
          <view class="title-row">
            <text>{{item.title}}</text>
            <view class="tags">
              <text wx:if="{{item.isHot}}" class="tag hot">热点</text>
              <text wx:if="{{item.isTop}}" class="tag top">置顶</text>
            </view>
          </view>
          <view class="meta-row">
            <view class="meta-left">
              <text>{{item.place}}</text>
            </view>
            <view class="meta-center"></view>
            <view class="meta-right">{{item.startDisplay}}</view>
          </view>
          <view class="signup-row">
            <view class="signup-status">
              <view class="flags">
                <block wx:for="{{item.flagIcons}}" wx:key="index">
                  <image class="flag-icon" src="{{item}}" mode="aspectFill" />
                </block>
              </view>
              <view class="signup-count">已报名 {{item.signed}}/{{item.max}}</view>
            </view>
            <view class="detail-btn" bindtap="onTap" data-id="{{item.id}}">活动详情</view>
          </view>
        </view>
      </block>
    </view>
    <view wx:if="{{activities.length===0}}" class="empty">未找到相关活动</view>
  </view>
</view>
