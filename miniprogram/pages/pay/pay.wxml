<view class="container">
  <view class="summary">
    <view class="amount">
      <view class="label">支付金额</view>
      <text class="price large">¥{{price}}</text>
    </view>
    <!-- 新增：活动信息摘要（左图右文三行） -->
    <view class="activity-summary">
      <image class="activity-thumb" src="{{activityImage}}" mode="aspectFill"/>
      <view class="activity-info">
        <view class="activity-title">{{activityTitle}}</view>
        <view class="activity-time">{{activityTimeRange}}</view>
        <view class="activity-place">{{activityPlace}}</view>
      </view>
    </view>
    <view class="calc" wx:if="{{selectedDeductYuan>0}}">
      <text>积分抵扣：¥{{selectedDeductYuan}}</text>
      <text style="margin-left:16rpx;">现金应付：¥{{cashPayable}}</text>
    </view>
  </view>



  <view class="panel" wx:if="{{prepayDetails}}">
    <view class="panel-title">抵扣明细</view>
    <view class="detail">
      <view>原价：¥{{prepayDetails.originalAmount}}</view>
      <view>代金券抵扣：¥{{prepayDetails.appliedVoucher}}</view>
      <view>积分抵扣：¥{{prepayDetails.pointsCashDeduction}}（使用{{prepayDetails.appliedPoints}}积分）</view>
      <view>现金应付：¥{{prepayDetails.finalPayable}}</view>
    </view>
  </view>

  <view class="pay-list">
    <view class="pay-item wechat {{paymentMethod==='wechat'?'active':''}}" data-method="wechat" bindtap="onSelectMethod">
      <view class="icon"><image mode="aspectFit" style="width:40rpx;height:40rpx;" src="{{iconWechat}}"/></view>
      <view class="name">微信支付</view>
      <view class="desc">需现金支付：¥{{cashPayable}}</view>
      <!-- 新增：右侧单选图标（选中/未选中） -->
      <image class="radio-icon" src="{{radioIconChosen}}" mode="aspectFit" wx:if="{{paymentMethod==='wechat'}}" binderror="onRadioIconError" data-kind="chosen"/>
      <image class="radio-icon" src="{{radioIconUnchosen}}" mode="aspectFit" wx:else binderror="onRadioIconError" data-kind="unchosen"/>
    </view>

    <view wx:if="{{enableAlipay}}" class="pay-item alipay {{paymentMethod==='alipay'?'active':''}}" data-method="alipay" bindtap="onSelectMethod">
      <view class="icon"><image mode="aspectFit" style="width:40rpx;height:40rpx;" src="{{iconAlipay}}"/></view>
      <view class="name">支付宝支付</view>
      <view class="desc">需现金支付：¥{{cashPayable}}</view>
      <!-- 新增：右侧单选图标（选中/未选中） -->
      <image class="radio-icon" src="{{radioIconChosen}}" mode="aspectFit" wx:if="{{paymentMethod==='alipay'}}" binderror="onRadioIconError" data-kind="chosen"/>
      <image class="radio-icon" src="{{radioIconUnchosen}}" mode="aspectFit" wx:else binderror="onRadioIconError" data-kind="unchosen"/>
    </view>

    <picker mode="selector" range="{{pointsLabels}}" bindchange="onPickerChange" value="{{selectedIndex}}" disabled="{{!pointsLabels || pointsLabels.length<=0}}">
      <view class="pay-item voucher {{canPointsOnly?'active':''}}">
        <view class="icon"><image mode="aspectFit" style="width:40rpx;height:40rpx;" src="{{iconVoucher}}"/></view>
        <view class="name">积分支付</view>
        <view class="desc" wx:if="{{selectedIndex>=0 && selectedDeductYuan>0}}">已选：抵¥{{selectedDeductYuan}}</view>
        <view class="desc" wx:else>未选择积分抵扣</view>
      </view>
    </picker>

    <view class="actions">
      <button class="btn cancel" bindtap="onCancelPay">取消</button>
      <button class="btn confirm" bindtap="onConfirmPay">确认支付</button>
    </view>
  </view>
</view>